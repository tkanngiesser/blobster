---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: test_datapipe.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">module_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">module_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_flavor</span> <span class="k">as</span> <span class="nn">pf</span>
<span class="kn">from</span> <span class="nn">vfu_package.datapipeline</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">service</span> <span class="o">=</span> <span class="s1">&#39;vfu&#39;</span>
<span class="n">datapipe</span><span class="o">.</span><span class="n">runtime</span> <span class="o">=</span> <span class="s1">&#39;local&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Items">Items<a class="anchor-link" href="#Items">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">step_consolidate_item_learning_levels</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mapping</span><span class="p">:</span>
        <span class="n">learning_level_names</span> <span class="o">=</span> <span class="n">mapping</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">learning_level_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="s1">&#39;1:Core&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="s1">&#39;2:Intermediate&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;3:Advanced&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="s1">&#39;4:Expert&#39;</span><span class="p">,</span> <span class="s1">&#39;SCM Essentials&#39;</span><span class="p">:</span><span class="s1">&#39;1:Core&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="s1">&#39;5:Others&#39;</span><span class="p">}</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing Info&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">learning_level_names</span><span class="p">)</span>  
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;Missing Info&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;assets&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="loading-raw-data:">loading raw data:<a class="anchor-link" href="#loading-raw-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="generating-raw-data-profile-report">generating raw data profile report<a class="anchor-link" href="#generating-raw-data-profile-report">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#items_raw_profile_report = datapipe.generate_profile_report(df=items_raw, mode=&#39;Raw&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="check-if-any-invalid-data:">check if any invalid data:<a class="anchor-link" href="#check-if-any-invalid-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">items_raw</span>
                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="cleaning-data:">cleaning data:<a class="anchor-link" href="#cleaning-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items_raw</span><span class="o">.</span><span class="n">modified</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">items_raw</span>
                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                 <span class="c1">#.step_format_dates(cols=[&#39;created&#39;], date_format=&#39;%m/%d/%Y&#39;)</span>
                 <span class="o">.</span><span class="n">step_format_dates</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;created&#39;</span><span class="p">])</span>
                 <span class="c1">#.step_format_dates(cols=[&#39;modified&#39;], date_format=&#39;%Y-%m-%d&#39;)</span>
                 <span class="o">.</span><span class="n">step_format_dates</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;modified&#39;</span><span class="p">])</span>
                 <span class="o">.</span><span class="n">step_format_round_numeric_column</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;average_rating&#39;</span><span class="p">,</span> <span class="n">decimal_places</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_consolidate_item_learning_levels</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;learning_level&#39;</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                 <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="generating-profile-report-of-cleaned-data">generating profile report of cleaned data<a class="anchor-link" href="#generating-profile-report-of-cleaned-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items_cleaned_profile_report</span> <span class="o">=</span> <span class="n">datapipe</span><span class="o">.</span><span class="n">generate_profile_report</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">items_cleaned</span><span class="p">,</span>
                                                                <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Cleaned&#39;</span><span class="p">,</span> 
                                                                <span class="n">save_to</span><span class="o">=</span><span class="s1">&#39;../data/dataquality/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">items_academy_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">items_cleaned</span><span class="o">.</span><span class="n">academy</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Current Academy Name&#39;</span><span class="p">])</span>
<span class="n">items_academy_df</span><span class="p">[</span><span class="s1">&#39;Consolidated Academy Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">items_academy_df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;../data/dataquality/vfu-streamline-academy-names.xlsx&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="nps">nps<a class="anchor-link" href="#nps">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;nps&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="loading-raw-data:">loading raw data:<a class="anchor-link" href="#loading-raw-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nps_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="generating-profile-report-of-raw-data">generating profile report of raw data<a class="anchor-link" href="#generating-profile-report-of-raw-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nps_raw_profile_report</span> <span class="o">=</span> <span class="n">datapipe</span><span class="o">.</span><span class="n">generate_profile_report</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">nps_raw</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Raw&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="check-if-any-invalid-data:">check if any invalid data:<a class="anchor-link" href="#check-if-any-invalid-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nps_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">nps_raw</span>
                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="cleaning-data:">cleaning data:<a class="anchor-link" href="#cleaning-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nps_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">nps_raw</span>
                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_format_dates</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;modified&#39;</span><span class="p">])</span>
                 <span class="o">.</span><span class="n">step_format_dates</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;created&#39;</span><span class="p">])</span>
                 <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="generating-profile-report-of-cleaned-data">generating profile report of cleaned data<a class="anchor-link" href="#generating-profile-report-of-cleaned-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nps_cleaned_profile_report</span> <span class="o">=</span> <span class="n">datapipe</span><span class="o">.</span><span class="n">generate_profile_report</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">nps_cleaned</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Cleaned&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="lms-asset-events">lms-asset-events<a class="anchor-link" href="#lms-asset-events">&#182;</a></h3><ul>
<li>data about items completed or not completed</li>
<li>in progress and assigned data is currently provided in separate files</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="lms-asset-events-specific-functions:">lms-asset-events specific functions:<a class="anchor-link" href="#lms-asset-events-specific-functions:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">step_consolidate_lms_item_assignment_types</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="n">mapping</span><span class="p">:</span>
        <span class="n">assignment_type_names</span> <span class="o">=</span> <span class="n">mapping</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">assignment_type_names</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;OPT&#39;</span><span class="p">:</span> <span class="s1">&#39;Optional&#39;</span><span class="p">,</span> <span class="s1">&#39;REC&#39;</span><span class="p">:</span><span class="s1">&#39;Recommended&#39;</span><span class="p">,</span> <span class="s1">&#39;REQ&#39;</span><span class="p">:</span><span class="s1">&#39;Mandatory&#39;</span><span class="p">}</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Optional&#39;</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">assignment_type_names</span><span class="p">)</span>  
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s1">&#39;Optional&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;lms-asset-events&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="loading-raw-data:">loading raw data:<a class="anchor-link" href="#loading-raw-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span><span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_items_completed_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
             <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
            <span class="p">)</span>
<span class="c1">#lms_items_completed_raw_profile_report = datapipe.generate_profile_report(df=items_raw, mode=&#39;Raw&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="generating-profile-report-of-raw-data">generating profile report of raw data<a class="anchor-link" href="#generating-profile-report-of-raw-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="check-if-any-invalid-data:">check if any invalid data:<a class="anchor-link" href="#check-if-any-invalid-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_items_completed_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">lms_items_completed_raw</span>
                               <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                              <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="cleaning-data:">cleaning data:<a class="anchor-link" href="#cleaning-data:">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_items_completed_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">lms_items_completed_raw</span>
                               <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_format_dates</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;completion_date&#39;</span><span class="p">])</span>
                               <span class="o">.</span><span class="n">step_consolidate_lms_item_assignment_types</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;assignment_type&#39;</span><span class="p">)</span>
                               <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                               <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                              <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_items_completed_cleaned</span><span class="o">.</span><span class="n">item_title</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;DRW&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="generating-profile-report-of-cleaned-data">generating profile report of cleaned data<a class="anchor-link" href="#generating-profile-report-of-cleaned-data">&#182;</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="page-hits">page hits<a class="anchor-link" href="#page-hits">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;page-hits&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">page_hits_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                 <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">page_hits_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">page_hits_raw</span>
                     <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">page_hits_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">page_hits_raw</span>
                     <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="global-navigation">global-navigation<a class="anchor-link" href="#global-navigation">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;global-navigation&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">global_navigation_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                         <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                         <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                         <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                        <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">global_navigation_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">global_navigation_raw</span>
                             <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">global_navigation_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">global_navigation_raw</span>
                             <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">global_navigation_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="search-page">search-page<a class="anchor-link" href="#search-page">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;search-page&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">search_page_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                  <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">search_page_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">search_page_raw</span>
                       <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                      <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">search_page_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">search_page_raw</span>
                       <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                      <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="of-course-me-launches">of-course-me-launches<a class="anchor-link" href="#of-course-me-launches">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;of-course-me-launches&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">of_course_me_launches_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">of_course_me_launches_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">of_course_me_launches_raw</span>
                                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">of_course_me_launches_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">of_course_me_launches_raw</span>
                                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="home-academy-sections">home-academy-sections<a class="anchor-link" href="#home-academy-sections">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;home-academy-sections&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">home_academy_sections_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                             <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">home_academy_sections_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">home_academy_sections_raw</span>
                                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">home_academy_sections_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">home_academy_sections_raw</span>
                                 <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                                 <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                                <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="traffic-sources">traffic-sources<a class="anchor-link" href="#traffic-sources">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;traffic-sources&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">traffic_sources_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                       <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                      <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">traffic_sources_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">traffic_sources_raw</span>
                           <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                          <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">traffic_sources_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">traffic_sources_raw</span>
                           <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                           <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                          <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ga-users">ga-users<a class="anchor-link" href="#ga-users">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;ga-users&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ga_users_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
               <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ga_users_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">ga_users_raw</span>
                    <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                   <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ga_users_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">ga_users_raw</span>
                    <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                    <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                   <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="asset-implicit-ratings">asset-implicit-ratings<a class="anchor-link" href="#asset-implicit-ratings">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;asset-implicit-ratings&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">asset_implicit_ratings_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                              <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                              <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                              <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                             <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">asset_implicit_ratings_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">asset_implicit_ratings_raw</span>
                                  <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                                 <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">asset_implicit_ratings_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">asset_implicit_ratings_raw</span>
                                  <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                                 <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="lms-items-in-progress">lms-items-in-progress<a class="anchor-link" href="#lms-items-in-progress">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">entity</span> <span class="o">=</span> <span class="s1">&#39;lms-assets-in-progress&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datapipe</span><span class="o">.</span><span class="n">definition</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>column_name_raw</th>
      <th>entity</th>
      <th>column_name_clean</th>
      <th>column_name_dashboard</th>
      <th>unique_identifier</th>
      <th>mandatory_field</th>
      <th>to_be_removed</th>
      <th>datatype</th>
      <th>Possible Values</th>
      <th>description</th>
      <th>Status2</th>
      <th>Needed actions</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">foo</span> <span class="o">=</span> <span class="n">azure_blob_storage</span><span class="o">.</span><span class="n">blob_to_df</span><span class="p">(</span><span class="n">container_name</span><span class="o">=</span><span class="s1">&#39;vfu-lms-assets-in-progress-raw&#39;</span><span class="p">,</span>
                                    <span class="n">blob_name</span><span class="o">=</span><span class="s1">&#39;report - 2019-12-11T145951.809.csv&#39;</span><span class="p">)</span>
<span class="n">foo</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>STUD_ID</th>
      <th>LNAME</th>
      <th>FNAME</th>
      <th>EMAIL_ADDR</th>
      <th>ITEM ID</th>
      <th>ITEM TYPE</th>
      <th>REV_DTE</th>
      <th>REV_NUM</th>
      <th>ITEM Market\r\n</th>
      <th>Item Title</th>
      <th>...</th>
      <th>Manager</th>
      <th>MGR_EMAIL_ADDR</th>
      <th>DELIVERY_TYPE\r\n</th>
      <th>ACADEMY</th>
      <th>LOCAL_CODE</th>
      <th>FUNCTION</th>
      <th>BAND</th>
      <th>COSTCENTRE</th>
      <th>User_Location</th>
      <th>Assignment_TYPE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>10250246</td>
      <td>Ford</td>
      <td>Graeme</td>
      <td>GRAEME.FORD@VODAFONE.COM</td>
      <td>6265740</td>
      <td>COURSE</td>
      <td>5 Jun 2019 05:34</td>
      <td>1</td>
      <td>VF_GB01</td>
      <td>What: Future Capabilities</td>
      <td>...</td>
      <td>1.03323e+07</td>
      <td>BENJAMIN.DAVIES@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>TE</td>
      <td>NaN</td>
      <td>Local Technology (TE00)</td>
      <td>H</td>
      <td>Transport Operations (GB07017010)</td>
      <td>At Customer Location (UK617)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10250246</td>
      <td>Ford</td>
      <td>Graeme</td>
      <td>GRAEME.FORD@VODAFONE.COM</td>
      <td>1760779857</td>
      <td>COURSE</td>
      <td>23 Aug 2017 12:00</td>
      <td>1</td>
      <td>VF</td>
      <td>TCP and UDP Operation for Cisco CCNA 200-125/1...</td>
      <td>...</td>
      <td>1.03323e+07</td>
      <td>BENJAMIN.DAVIES@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>Local Technology (TE00)</td>
      <td>Transport Operations (GB07017010)</td>
      <td>TE</td>
      <td>H</td>
      <td>Networks</td>
      <td>At Customer Location (UK617)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>10250246</td>
      <td>Ford</td>
      <td>Graeme</td>
      <td>GRAEME.FORD@VODAFONE.COM</td>
      <td>1201269208</td>
      <td>COURSE</td>
      <td>23 Aug 2017 12:00</td>
      <td>1</td>
      <td>VF</td>
      <td>Network Address Translation (NAT) for Cisco CC...</td>
      <td>...</td>
      <td>1.03323e+07</td>
      <td>BENJAMIN.DAVIES@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>Local Technology (TE00)</td>
      <td>Transport Operations (GB07017010)</td>
      <td>TE</td>
      <td>H</td>
      <td>Networks</td>
      <td>At Customer Location (UK617)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10250246</td>
      <td>Ford</td>
      <td>Graeme</td>
      <td>GRAEME.FORD@VODAFONE.COM</td>
      <td>20204605</td>
      <td>COURSE</td>
      <td>23 Aug 2017 12:00</td>
      <td>1</td>
      <td>VF</td>
      <td>Access Control Lists (ACLs) for Cisco CCNA 200...</td>
      <td>...</td>
      <td>1.03323e+07</td>
      <td>BENJAMIN.DAVIES@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>Local Technology (TE00)</td>
      <td>Transport Operations (GB07017010)</td>
      <td>TE</td>
      <td>H</td>
      <td>Networks</td>
      <td>At Customer Location (UK617)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10250246</td>
      <td>Ford</td>
      <td>Graeme</td>
      <td>GRAEME.FORD@VODAFONE.COM</td>
      <td>1030157725</td>
      <td>COURSE</td>
      <td>23 Aug 2017 12:00</td>
      <td>1</td>
      <td>VF</td>
      <td>Securing the Switch for Cisco CCNA 200-125/100...</td>
      <td>...</td>
      <td>1.03323e+07</td>
      <td>BENJAMIN.DAVIES@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>Local Technology (TE00)</td>
      <td>Transport Operations (GB07017010)</td>
      <td>TE</td>
      <td>H</td>
      <td>Networks</td>
      <td>At Customer Location (UK617)</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>78301</th>
      <td>VF00WM00028494</td>
      <td>Agrawal</td>
      <td>Chandarani</td>
      <td>chanda_rani@rediffmail.com</td>
      <td>1638001</td>
      <td>COURSE</td>
      <td>16 Oct 2017 06:26</td>
      <td>1</td>
      <td>VF</td>
      <td>Perspectives</td>
      <td>...</td>
      <td>11297230</td>
      <td>SANDEEP.SHENOLIKAR@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>HR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>REQ</td>
    </tr>
    <tr>
      <th>78302</th>
      <td>VF00WM00028494</td>
      <td>Agrawal</td>
      <td>Chandarani</td>
      <td>chanda_rani@rediffmail.com</td>
      <td>2120002</td>
      <td>COURSE</td>
      <td>22 Nov 2017 05:33</td>
      <td>1</td>
      <td>VF_GB01</td>
      <td>UK Business Continuity Management</td>
      <td>...</td>
      <td>11297230</td>
      <td>SANDEEP.SHENOLIKAR@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>HR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78303</th>
      <td>VF00WM00028743</td>
      <td>Bateman</td>
      <td>Paul</td>
      <td>PIBATEMAN@HOTMAIL.CO.UK</td>
      <td>2120002</td>
      <td>COURSE</td>
      <td>22 Nov 2017 05:33</td>
      <td>1</td>
      <td>VF_GB01</td>
      <td>UK Business Continuity Management</td>
      <td>...</td>
      <td>11306316</td>
      <td>ANIL.DEOL@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>HR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>78304</th>
      <td>VF00WM00028743</td>
      <td>Bateman</td>
      <td>Paul</td>
      <td>PIBATEMAN@HOTMAIL.CO.UK</td>
      <td>1638001</td>
      <td>COURSE</td>
      <td>16 Oct 2017 06:26</td>
      <td>1</td>
      <td>VF</td>
      <td>Perspectives</td>
      <td>...</td>
      <td>11306316</td>
      <td>ANIL.DEOL@VODAFONE.COM</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>HR</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>REQ</td>
    </tr>
    <tr>
      <th>78305</th>
      <td>WARDA.ABDELGHOFFAR</td>
      <td>Abdelghoffar</td>
      <td>Warda</td>
      <td>warda.abdelghoffar@vodafone.com</td>
      <td>6265096</td>
      <td>COURSE</td>
      <td>18 Apr 2019 13:48</td>
      <td>1</td>
      <td>VF</td>
      <td>Vodafone Business - Introduction to Salesforce...</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CONTINUOUS ONLINE ACCESS</td>
      <td>SF</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>VGA France</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>78306 rows  31 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_assets_in_progress_raw</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
                              <span class="o">.</span><span class="n">step_load_entity_definition</span><span class="p">()</span>
                              <span class="o">.</span><span class="n">step_load_raw_data</span><span class="p">()</span>
                              <span class="o">.</span><span class="n">step_rename_columns</span><span class="p">()</span>
                             <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-31-ee6007d21d8c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> lms_assets_in_progress_raw = (pd.DataFrame()
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                               <span class="ansi-blue-fg">.</span>step_load_entity_definition<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>                               <span class="ansi-blue-fg">.</span>step_load_raw_data<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>                               <span class="ansi-blue-fg">.</span>step_rename_columns<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>                              )

<span class="ansi-green-fg">~/opt/anaconda3/envs/vfu/lib/python3.7/site-packages/pandas_flavor/register.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span>             <span class="ansi-blue-fg">@</span>wraps<span class="ansi-blue-fg">(</span>method<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span>             <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 29</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> method<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_obj<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span> 
<span class="ansi-green-intense-fg ansi-bold">     31</span>         register_dataframe_accessor<span class="ansi-blue-fg">(</span>method<span class="ansi-blue-fg">.</span>__name__<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>AccessorMethod<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Repos/vfu_datapipe/vfu_package/datapipeline.py</span> in <span class="ansi-cyan-fg">step_rename_columns</span><span class="ansi-blue-fg">(df)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span>         )
<span class="ansi-green-intense-fg ansi-bold">    252</span>     )
<span class="ansi-green-fg">--&gt; 253</span><span class="ansi-red-fg">     </span>df <span class="ansi-blue-fg">=</span> df<span class="ansi-blue-fg">.</span>rename_columns<span class="ansi-blue-fg">(</span>column_names_mapping<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    254</span>     <span class="ansi-green-fg">return</span> df
<span class="ansi-green-intense-fg ansi-bold">    255</span> 

<span class="ansi-green-fg">~/opt/anaconda3/envs/vfu/lib/python3.7/site-packages/pandas_flavor/register.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span>             <span class="ansi-blue-fg">@</span>wraps<span class="ansi-blue-fg">(</span>method<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span>             <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 29</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> method<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_obj<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span> 
<span class="ansi-green-intense-fg ansi-bold">     31</span>         register_dataframe_accessor<span class="ansi-blue-fg">(</span>method<span class="ansi-blue-fg">.</span>__name__<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>AccessorMethod<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/vfu/lib/python3.7/site-packages/janitor/functions.py</span> in <span class="ansi-cyan-fg">rename_columns</span><span class="ansi-blue-fg">(df, new_column_names)</span>
<span class="ansi-green-intense-fg ansi-bold">    500</span>     <span class="ansi-blue-fg">:</span>returns<span class="ansi-blue-fg">:</span> A pandas DataFrame <span class="ansi-green-fg">with</span> renamed columns<span class="ansi-blue-fg">.</span>
<span class="ansi-green-intense-fg ansi-bold">    501</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 502</span><span class="ansi-red-fg">     </span>check_column<span class="ansi-blue-fg">(</span>df<span class="ansi-blue-fg">,</span> list<span class="ansi-blue-fg">(</span>new_column_names<span class="ansi-blue-fg">.</span>keys<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    503</span> 
<span class="ansi-green-intense-fg ansi-bold">    504</span>     <span class="ansi-green-fg">return</span> df<span class="ansi-blue-fg">.</span>rename<span class="ansi-blue-fg">(</span>columns<span class="ansi-blue-fg">=</span>new_column_names<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/opt/anaconda3/envs/vfu/lib/python3.7/site-packages/janitor/utils.py</span> in <span class="ansi-cyan-fg">check_column</span><span class="ansi-blue-fg">(df, old_column_names, present)</span>
<span class="ansi-green-intense-fg ansi-bold">    342</span>             <span class="ansi-green-fg">if</span> column_name <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> df<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    343</span>                 raise ValueError(
<span class="ansi-green-fg">--&gt; 344</span><span class="ansi-red-fg">                     </span><span class="ansi-blue-fg">f&#34;{column_name} not present in dataframe columns!&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    345</span>                 )
<span class="ansi-green-intense-fg ansi-bold">    346</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>  <span class="ansi-red-fg"># Tests for exclusion</span>

<span class="ansi-red-fg">ValueError</span>: ITEM Market\r\n not present in dataframe columns!</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_assets_in_progress_invalid</span> <span class="o">=</span> <span class="p">(</span><span class="n">lms_assets_in_progress_raw</span>
                                  <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_validate_data</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_store_invalid_data</span><span class="p">()</span>
                                 <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_assets_in_progress_raw</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;STUD_ID&#39;, &#39;LNAME&#39;, &#39;FNAME&#39;, &#39;EMAIL_ADDR&#39;, &#39;ITEM ID&#39;, &#39;ITEM TYPE&#39;,
       &#39;REV_DTE&#39;, &#39;REV_NUM&#39;, &#39;ITEM Market\r\n&#39;, &#39;Item Title&#39;, &#39;Assign Date&#39;,
       &#39;Status&#39;, &#39;Credit Hours&#39;, &#39;Duration&#39;, &#39;Grade&#39;, &#39;Scheduled Offering ID&#39;,
       &#39;Instructor Name&#39;, &#39;ITEM_SOURCE&#39;, &#39;USER MARKET&#39;, &#39;ORG_ID&#39;, &#39;ORG_DESC&#39;,
       &#39;Manager&#39;, &#39;MGR_EMAIL_ADDR&#39;, &#39;DELIVERY_TYPE\r\n&#39;, &#39;ACADEMY&#39;,
       &#39;LOCAL_CODE&#39;, &#39;FUNCTION&#39;, &#39;BAND&#39;, &#39;COSTCENTRE&#39;, &#39;User_Location&#39;,
       &#39;Assignment_TYPE&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lms_assets_in_progress_cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">lms_assets_in_progress_raw</span>
                                  <span class="o">.</span><span class="n">step_replace_missing_values_with_nan</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_remove_not_needed_columns</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_remove_rows_with_invalid_ids</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_remove_duplicate_rows</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_format_dates</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;completion_date&#39;</span><span class="p">])</span>
                                  <span class="o">.</span><span class="n">step_consolidate_lms_item_assignment_types</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;assignment_type&#39;</span><span class="p">)</span>
                                  <span class="o">.</span><span class="n">step_change_datatypes</span><span class="p">()</span>
                                  <span class="o">.</span><span class="n">step_store_cleaned_data</span><span class="p">()</span>
                                 <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0, 32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="user-profiles">user profiles<a class="anchor-link" href="#user-profiles">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">azure_blob_storage</span><span class="o">.</span><span class="n">list_all_blobs</span><span class="p">(</span><span class="n">container_name</span><span class="o">=</span><span class="s1">&#39;vfu-user-profiles-raw&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_profiles_old</span> <span class="o">=</span> <span class="n">azure_blob_storage</span><span class="o">.</span><span class="n">blob_to_df</span><span class="p">(</span><span class="n">container_name</span><span class="o">=</span><span class="s1">&#39;vfu-user-profiles-raw&#39;</span><span class="p">,</span> <span class="n">blob_name</span><span class="o">=</span><span class="s1">&#39;vfu-user-profiles-raw.json&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_profiles_weekly</span> <span class="o">=</span> <span class="n">azure_blob_storage</span><span class="o">.</span><span class="n">blob_to_df</span><span class="p">(</span><span class="n">container_name</span><span class="o">=</span><span class="s1">&#39;vfu-user-profiles-raw&#39;</span><span class="p">,</span> <span class="n">blob_name</span><span class="o">=</span><span class="s1">&#39;vfu-user-profiles-weekly-raw.json&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_profiles_weekly</span><span class="p">[</span><span class="n">user_profiles_weekly</span><span class="o">.</span><span class="n">VFLPLOCALMARKET</span> <span class="o">==</span> <span class="s1">&#39;UK&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">EMPLOYEEID</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([nan])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_profiles_weekly</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">user_profiles_old</span><span class="p">[(</span><span class="n">user_profiles_old</span><span class="o">.</span><span class="n">VFUCAREERGROUP</span><span class="o">.</span><span class="n">notnull</span><span class="p">())</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">user_profiles_old</span><span class="o">.</span><span class="n">VFLPLOCALMARKET</span> <span class="o">==</span> <span class="s1">&#39;UK&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="step_summarize_if(df)">step_summarize_if(df)<a class="anchor-link" href="#step_summarize_if(df)">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pandas_flavor</span> <span class="k">as</span> <span class="nn">pf</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">raw_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;first_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Jason&#39;</span><span class="p">,</span> <span class="s1">&#39;Molly&#39;</span><span class="p">,</span> <span class="s1">&#39;Tina&#39;</span><span class="p">,</span> <span class="s1">&#39;Jake&#39;</span><span class="p">,</span> <span class="s1">&#39;Amy&#39;</span><span class="p">],</span> 
        <span class="s1">&#39;last_name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Miller&#39;</span><span class="p">,</span> <span class="s1">&#39;Jacobson&#39;</span><span class="p">,</span> <span class="s1">&#39;Ali&#39;</span><span class="p">,</span> <span class="s1">&#39;Milner&#39;</span><span class="p">,</span> <span class="s1">&#39;Cooze&#39;</span><span class="p">],</span> 
        <span class="s1">&#39;age&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">73</span><span class="p">],</span> 
        <span class="s1">&#39;preTestScore&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="s1">&#39;postTestScore&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">70</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">raw_data</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;preTestScore&#39;</span><span class="p">,</span> <span class="s1">&#39;postTestScore&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>first_name</th>
      <th>last_name</th>
      <th>age</th>
      <th>preTestScore</th>
      <th>postTestScore</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jason</td>
      <td>Miller</td>
      <td>42</td>
      <td>4</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Molly</td>
      <td>Jacobson</td>
      <td>52</td>
      <td>24</td>
      <td>94</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Tina</td>
      <td>Ali</td>
      <td>36</td>
      <td>31</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jake</td>
      <td>Milner</td>
      <td>24</td>
      <td>2</td>
      <td>62</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Amy</td>
      <td>Cooze</td>
      <td>73</td>
      <td>3</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">version_info</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>sys.version_info(major=3, minor=7, micro=4, releaselevel=&#39;final&#39;, serial=0)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">x</span><span class="p">:</span><span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-5-77ddb247c5cc&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">1</span>
<span class="ansi-red-fg">    [x:= x**2 for x in [1, 2, 3, 4, 5]]</span>
      ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@pf</span><span class="o">.</span><span class="n">register_dataframe_method</span>
<span class="k">def</span> <span class="nf">step_summarize_if</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">funs</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cond</span> <span class="o">==</span> <span class="s1">&#39;all_numeric&#39;</span><span class="p">:</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
        
    <span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{col}</span><span class="s1">_</span><span class="si">{f.__name__}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funs</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-cyan-fg">  File </span><span class="ansi-green-fg">&#34;&lt;ipython-input-4-041e39f263b2&gt;&#34;</span><span class="ansi-cyan-fg">, line </span><span class="ansi-green-fg">8</span>
<span class="ansi-red-fg">    [df[f&#39;{col}_{f.__name__}&#39;] := f(df[col].values) for col in cols for f in funs]</span>
                               ^
<span class="ansi-red-fg">SyntaxError</span><span class="ansi-red-fg">:</span> invalid syntax
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">step_summarize_if</span><span class="p">(</span><span class="n">cond</span> <span class="o">=</span> <span class="s1">&#39;all_numeric&#39;</span><span class="p">,</span> <span class="n">funs</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cond</span> <span class="o">=</span> <span class="s1">&#39;df.select_dtypes(include=np.number)&#39;</span>
<span class="n">pd</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;df[&quot;first_name&quot;]&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>
 

